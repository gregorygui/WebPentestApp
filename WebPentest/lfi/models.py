from django.db import models
from django.core.exceptions import ValidationError

# Create your models here.

class Attack(models.Model):
	name = models.CharField(max_length=50)
	Type_Attack = (
        ('lfi', 'LFI'),
        ('sql','SQL Injection')
    )
	description = models.CharField(max_length=500)
	pub_date = models.DateTimeField('date published')
	
	typeAttack = models.CharField(max_length=20,choices=Type_Attack,default='lfi')
	criticity = models.IntegerField(default=1)
	request = models.CharField(max_length=500,default='0')

	def __str__(self):
		return self.description

	def iscritical(self):
		return self.criticity>=3
	iscritical.boolean=True
	iscritical.short_description="Is it Critical ?"

	def noblankrequest(self):
		if self.request == '0':
			raise ValidationError('Empty request')

	def correctcriticity(self):
		if self.criticity>5 or self.criticity<1:
			raise ValidationError('Incorrect criticity (between 1 and 5)')