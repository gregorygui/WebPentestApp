from django.shortcuts import render
from django.http import HttpResponse
from django.views import generic
from .models import NameAttack, DetailedAttack
from .forms import FormDetailedAttack, FormNameAttack

def index(request):
	return render(request, 'lfi/index.html', {'attack':NameAttack.objects.all()})

def attack(request, sname):
	at=NameAttack.objects.get(surname=sname)
	det=at.detailedattack_set.all()
	return render(request, 'lfi/attack.html', {
		'attack':NameAttack.objects.all(),
		'at':at,
		'det':det
		})

def detail(request, sname, nb):
	at=NameAttack.objects.get(surname=sname)
	det=at.detailedattack_set.get(id=nb)
	return render(request, 'lfi/detail.html',{
		'attack':NameAttack.objects.all(),
		'det':det,
		'at':at
		})

def add_DetailedAttack(request,sname,action):
	if request.method=='POST':
		
		form=FormDetailedAttack(request.POST)

		if not form['Add']:
			return render(request, 'lfi/add_DetailAttack.html', {
				'attack':NameAttack.objects.get(surname=sname)
				})
		
	else:
		at=NameAttack.objects.get(surname=sname)
		return render(request, 'lfi/add_DetailedAttack.html', {
			'attack':NameAttack.objects.all(),
			'at':at,
			'form':FormDetailedAttack,
			'action':action
			})

def add_NameAttack(request,action,sname='New'):
	if request.method=='POST':
		
		form=FormNameAttack(request.POST)

		if not form['Add']:
			return render(request, 'lfi/add_NameAttack.html', {
				'attack':NameAttack.objects.all()
				})
		
	else:
		return render(request, 'lfi/add_NameAttack.html', {
			'attack':NameAttack.objects.all(),
			'form':FormNameAttack(),
			'action':action,
			'mod':NameAttack.objects.get(surname=sname)
			})